function addCommas(e){e+="";for(var i=e.split("."),a=i[0],t=i.length>1?"."+i[1]:"",r=/(\d+)(\d{3})/;r.test(a);)a=a.replace(r,"$1,$2");return a+t}function camelize(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,i){return 0==i?e.toLowerCase():e.toUpperCase()}).replace(/\s+/g,"")}var allLayers;require(["esri/geometry/Extent","esri/layers/WMSLayerInfo","esri/layers/FeatureLayer","dojo/domReady!"],function(e,i,a){allLayers=[]});var map,allLayers,maxLegendHeight,maxLegendDivHeight;require(["esri/map","esri/SnappingManager","esri/dijit/HomeButton","esri/dijit/Measurement","application/bootstrapmap","esri/layers/ArcGISTiledMapServiceLayer","esri/dijit/Geocoder","esri/dijit/PopupTemplate","esri/graphic","esri/geometry/Multipoint","esri/symbols/PictureMarkerSymbol","esri/geometry/webMercatorUtils","esri/config","dojo/keys","dojo/has","dojo/dom","dojo/on","dojo/domReady!"],function(e,i,a,t,r,o,s,n,l,c,d,p,m,g,u,h,y){function v(){1===h.byId("chkExtent").checked?V.activeGeocoder.searchExtent=map.extent:V.activeGeocoder.searchExtent=null}function L(){v();var e=V.find();e.then(function(e){b(e)}),$("#geosearchModal").modal("hide")}function f(e){x();var i=e.graphic?e.graphic:e.result.feature;i.setSymbol(z),M(e.result,i.symbol)}function b(e){if(e=e.results,e.length>0){x();for(var i=z,a=0;a<e.length;a++)M(e[a],i);w(e)}}function S(e){var i=e.indexOf(",");return i>0&&(e=e.substring(0,i)),e}function M(e,i){var a,t,r,o,s={};r=e.feature.geometry,s.address=e.name,s.score=e.feature.attributes.Score,a={address:S(s.address),score:s.score,lat:r.getLatitude().toFixed(2),lon:r.getLongitude().toFixed(2)},t=new n({title:"{address}",description:"Latitude: {lat}<br/>Longitude: {lon}"}),o=new l(r,i,a,t),map.graphics.add(o)}function w(e){for(var i=new c(map.spatialReference),a=0;a<e.length;a++)i.addPoint(e[a].feature.geometry);map.setExtent(i.getExtent().expand(2))}function x(){map.infoWindow.hide(),map.graphics.clear()}function k(e,i,a,t,r){return new d({angle:0,xoffset:i,yoffset:a,type:"esriPMS",url:e,contentType:"image/png",width:t,height:r})}map=e("mapDiv",{basemap:"gray",center:[-82.745,41.699],zoom:10});var C=new a({map:map},"homeButton");C.startup();var D=new t({map:map},h.byId("measurementDiv"));D.startup(),esri.config.defaults.io.corsEnabledServers.push("http://52.0.108.106:6080/"),$(window).resize(function(){$("#legendCollapse").hasClass("in")?(maxLegendHeight=.9*$("#mapDiv").height(),$("#legendElement").css("height",maxLegendHeight),$("#legendElement").css("max-height",maxLegendHeight),maxLegendDivHeight=$("#legendElement").height()-parseInt($("#legendHeading").css("height").replace("px","")),$("#legendDiv").css("max-height",maxLegendDivHeight)):$("#legendElement").css("height","initial")}),y(map,"load",function(){var e=map.getScale().toFixed(0);$("#scale")[0].innerHTML=addCommas(e);var i=p.webMercatorToGeographic(map.extent.getCenter());$("#latitude").html(i.y.toFixed(3)),$("#longitude").html(i.x.toFixed(3))}),y(map,"zoom-end",function(){var e=map.getScale().toFixed(0);$("#scale")[0].innerHTML=addCommas(e)}),y(map,"mouse-move",function(e){if($("#mapCenterLabel").css("display","none"),null!=e.mapPoint){var i=p.webMercatorToGeographic(e.mapPoint);$("#latitude").html(i.y.toFixed(3)),$("#longitude").html(i.x.toFixed(3))}}),y(map,"pan-end",function(){$("#mapCenterLabel").css("display","inline");var e=p.webMercatorToGeographic(map.extent.getCenter());$("#latitude").html(e.y.toFixed(3)),$("#longitude").html(e.x.toFixed(3))});var I=new o("http://basemap.nationalmap.gov/arcgis/rest/services/USGSTopo/MapServer");y(h.byId("btnStreets"),"click",function(){map.setBasemap("streets"),map.removeLayer(I)}),y(h.byId("btnSatellite"),"click",function(){map.setBasemap("satellite"),map.removeLayer(I)}),y(h.byId("btnHybrid"),"click",function(){map.setBasemap("hybrid"),map.removeLayer(I)}),y(h.byId("btnTerrain"),"click",function(){map.setBasemap("terrain"),map.removeLayer(I)}),y(h.byId("btnGray"),"click",function(){map.setBasemap("gray"),map.removeLayer(I)}),y(h.byId("btnNatGeo"),"click",function(){map.setBasemap("national-geographic"),map.removeLayer(I)}),y(h.byId("btnOSM"),"click",function(){map.setBasemap("osm"),map.removeLayer(I)}),y(h.byId("btnTopo"),"click",function(){map.setBasemap("topo"),map.removeLayer(I)}),y(h.byId("btnNatlMap"),"click",function(){map.addLayer(I)});var V=new s({value:"",maxLocations:25,autoComplete:!0,arcgisGeocoder:!0,autoNavigate:!1,map:map},"geosearch");V.startup(),V.on("select",f),V.on("findResults",b),V.on("clear",x),y(V.inputNode,"keydown",function(e){13==e.keyCode&&v()});var z=k("../src/images/purple-pin.png",0,12,13,24);map.on("load",function(){map.infoWindow.set("highlight",!1),map.infoWindow.set("titleInBody",!1)}),y(h.byId("btnGeosearch"),"click",L),$(document).ready(function(){function e(){$("#geosearchModal").modal("show")}$("#geosearchNav").click(function(){e()}),$("#html").niceScroll(),$("#sidebar").niceScroll(),$("#sidebar").scroll(function(){$("#sidebar").getNiceScroll().resize()}),$("#legendDiv").niceScroll(),maxLegendHeight=.9*$("#mapDiv").height(),$("#legendElement").css("max-height",maxLegendHeight),$("#legendCollapse").on("shown.bs.collapse",function(){maxLegendHeight=.9*$("#mapDiv").height(),$("#legendElement").css("max-height",maxLegendHeight),maxLegendDivHeight=$("#legendElement").height()-parseInt($("#legendHeading").css("height").replace("px","")),$("#legendDiv").css("max-height",maxLegendDivHeight)}),$("#legendCollapse").on("hide.bs.collapse",function(){$("#legendElement").css("height","initial")})}),require(["esri/dijit/Legend","esri/tasks/locator","esri/tasks/query","esri/tasks/QueryTask","esri/graphicsUtils","esri/geometry/Point","esri/geometry/Extent","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/FeatureLayer","esri/layers/WMSLayer","esri/layers/WebTiledLayer","dojo/query","dojo/dom"],function(e,i,a,t,r,o,s,n,l,c,d,p,m){var h=[],y=[];const v="http://wlera.wimcloud.usgs.gov:6080/arcgis/rest/services/WLERA/",L=new n(v+"reference/MapServer",{id:"hexRef",visible:!0});L.setVisibleLayers([0]),y.push(L),h.push({layer:L,title:" "}),L.inLegendLayers=!0;const f=new n(v+"reference/MapServer",{id:"studyArea",visible:!0});f.setVisibleLayers([1]),y.push(f),h.push({layer:f,title:" "}),f.inLegendLayers=!0;const b=new l(v+"reference/MapServer/2",{id:"parcels",visible:!1,minScale:1e5,mode:l.MODE_ONDEMAND,outfields:["*"]});y.push(b),b.inLegendLayers=!1;const S=new n(v+"hydroCondition/MapServer",{id:"dikeBreaks",visible:!1,minScale:1e5});S.setVisibleLayers([1]),y.push(S),S.inLegendLayers=!1;const M=new n(v+"hydroCondition/MapServer",{id:"culverts",visible:!1,minScale:1e5});M.setVisibleLayers([2]),y.push(M),M.inLegendLayers=!1;const w=new n(v+"hydroCondition/MapServer",{id:"degFlowlines",visible:!1,minScale:1e5});w.setVisibleLayers([3]),y.push(w),w.inLegendLayers=!1;const x=new n(v+"hydroCondition/MapServer",{id:"dikes",visible:!1,minScale:1e5});x.setVisibleLayers([5]),y.push(x),x.inLegendLayers=!1;const k=new n(v+"hydroCondition/MapServer",{id:"dikedAreas",visible:!1});k.setVisibleLayers([6]),y.push(k),k.inLegendLayers=!1;const C=new n(v+"restorationModel/MapServer",{id:"waterMask",visible:!1});C.setVisibleLayers([2]),y.push(C),C.inLegendLayers=!1;const D=new n(v+"restorationModel/MapServer",{id:"hydroperiod",visible:!1});D.setVisibleLayers([3]),y.push(D),D.inLegendLayers=!1;const I=new n(v+"restorationModel/MapServer",{id:"wetsoils",visible:!1});I.setVisibleLayers([4]),y.push(I),I.inLegendLayers=!1;const V=new n(v+"restorationModel/MapServer",{id:"flowline",visible:!1});V.setVisibleLayers([5]),y.push(V),V.inLegendLayers=!1;const z=new n(v+"restorationModel/MapServer",{id:"conservedLands",visible:!1});z.setVisibleLayers([6]),y.push(z),z.inLegendLayers=!1;const E=new n(v+"restorationModel/MapServer",{id:"imperviousSurfaces",visible:!1});E.setVisibleLayers([7]),y.push(E),E.inLegendLayers=!1;const G=new n(v+"restorationModel/MapServer",{id:"landuse",visible:!1});G.setVisibleLayers([8]),y.push(G),G.inLegendLayers=!1;const H=new n(v+"restorationModel/MapServer",{id:"normalized",visible:!0});H.setVisibleLayers([9]),y.push(H),h.push({layer:H,title:" "}),H.inLegendLayers=!0;const B=new n(v+"restorationModel/MapServer",{id:"highRestore",visible:!1});B.setVisibleLayers([11]),y.push(B),B.inLegendLayers=!1;const T=new n(v+"restorationModel/MapServer",{id:"mediumRestore",visible:!1});T.setVisibleLayers([12]),y.push(T),T.inLegendLayers=!1;const j=new n(v+"restorationModel/MapServer",{id:"lowRestore",visible:!1});j.setVisibleLayers([13]),y.push(j),j.inLegendLayers=!1;const q=new n(v+"restorationModel/MapServer",{id:"noRestore",visible:!1});q.setVisibleLayers([14]),y.push(q),q.inLegendLayers=!1,map.addLayers(y);var F=map.enableSnapping({snapKey:u("mac")?g.META:g.CTRL}),R=[{layer:b}];F.setLayerInfos(R);for(var N=0;N<map.layerIds.length;N++){var A=map.getLayer(map.layerIds[N]);A.visible&&($("#"+A.id).button("toggle"),$("#"+A.id).find("i.checkBoxIcon").toggleClass("fa-check-square-o fa-square-o"))}$("button.lyrTog").click(function(e){$(this).find("i.checkBoxIcon").toggleClass("fa-check-square-o fa-square-o"),$(this).button("toggle"),e.preventDefault(),e.stopPropagation();var i=map.getLayer($(this).attr("id"));i.visible?i.setVisibility(!1):(i.setVisibility(!0),0==i.inLegendLayers&&(h.push({layer:i,title:" "}),P.refresh()))}),$("#hydroConditionGroup, #parametersGroup, #4scaleGroup").on("hide.bs.collapse",function(){var e=$(this)[0].id.replace("Group","");$("#"+e).find("i.checkBoxIcon").toggleClass("fa-check-square-o fa-square-o"),$("#"+e).find("i.chevron").toggleClass("fa-chevron-right fa-chevron-down");var i=$(this).attr("id")+"Buttons";$("#"+i).button("toggle")}),$("#hydroConditionGroup, #parametersGroup, #4scaleGroup").on("show.bs.collapse",function(){var e=$(this)[0].id.replace("Group","");$("#"+e).find("i.checkBoxIcon").toggleClass("fa-check-square-o fa-square-o"),$("#"+e).find("i.chevron").toggleClass("fa-chevron-right fa-chevron-down")}),$(".zoomto").hover(function(e){$(".zoomDialog").remove();var i=this.parentNode.id,a=$('<div class="zoomDialog"><label class="zoomClose pull-right">X</label><br><div class="list-group"><a href="#" id="zoomscale" class="list-group-item zoomscale">Zoom to scale</a> <a id="zoomcenter" href="#" class="list-group-item zoomcenter">Zoom to center</a></div></div>');$("body").append(a),$(".zoomDialog").css("left",event.clientX-80),$(".zoomDialog").css("top",event.clientY-5),$(".zoomDialog").mouseleave(function(){$(".zoomDialog").remove()}),$(".zoomClose").click(function(){$(".zoomDialog").remove()}),$("#zoomscale").click(function(e){var a=map.getLayer(i).minScale;map.setScale(a)}),$("#zoomcenter").click(function(e){var a=map.getLayer(i).fullExtent.getCenter();map.centerAt(a)})}),$(".opacity").hover(function(){$(".opacitySlider").remove();var e=this.parentNode.id,i=map.getLayer(e).opacity,a=$('<div class="opacitySlider"><label id="opacityValue">Opacity: '+i+'</label><label class="opacityClose pull-right">X</label><input id="slider" type="range"></div>');$("body").append(a),$("#slider")[0].value=100*i,$(".opacitySlider").css("left",event.clientX-180),$(".opacitySlider").css("top",event.clientY-5),$(".opacitySlider").mouseleave(function(){$(".opacitySlider").remove()}),$(".opacityClose").click(function(){$(".opacitySlider").remove()}),$("#slider").change(function(i){var a=$("#slider")[0].value/100;console.log("o: "+a),$("#opacityValue").html("Opacity: "+a),map.getLayer(e).setOpacity(a)})});var P=new e({map:map,layerInfos:h},"legendDiv");P.startup()})}),$(document).ready(function(){});