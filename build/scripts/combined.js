function addCommas(e){e+="";for(var i=e.split("."),a=i[0],t=i.length>1?"."+i[1]:"",o=/(\d+)(\d{3})/;o.test(a);)a=a.replace(o,"$1,$2");return a+t}function camelize(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,i){return 0==i?e.toLowerCase():e.toUpperCase()}).replace(/\s+/g,"")}var allLayers;require(["esri/geometry/Extent","esri/layers/WMSLayerInfo","esri/layers/FeatureLayer","dojo/domReady!"],function(e,i,a){allLayers=[]});var map,allLayers,maxLegendHeight,maxLegendDivHeight;require(["esri/map","esri/SnappingManager","esri/dijit/HomeButton","esri/dijit/Measurement","application/bootstrapmap","esri/layers/ArcGISTiledMapServiceLayer","esri/dijit/Geocoder","esri/dijit/PopupTemplate","esri/graphic","esri/geometry/Multipoint","esri/symbols/PictureMarkerSymbol","esri/geometry/webMercatorUtils","esri/config","dojo/keys","dojo/has","dojo/dom","dojo/on","dojo/domReady!"],function(e,i,a,t,o,r,s,n,l,d,c,p,m,g,u,h,y){function v(){1===h.byId("chkExtent").checked?V.activeGeocoder.searchExtent=map.extent:V.activeGeocoder.searchExtent=null}function L(){v();var e=V.find();e.then(function(e){b(e)}),$("#geosearchModal").modal("hide")}function f(e){x();var i=e.graphic?e.graphic:e.result.feature;i.setSymbol(z),M(e.result,i.symbol)}function b(e){if(e=e.results,e.length>0){x();for(var i=z,a=0;a<e.length;a++)M(e[a],i);w(e)}}function S(e){var i=e.indexOf(",");return i>0&&(e=e.substring(0,i)),e}function M(e,i){var a,t,o,r,s={};o=e.feature.geometry,s.address=e.name,s.score=e.feature.attributes.Score,a={address:S(s.address),score:s.score,lat:o.getLatitude().toFixed(2),lon:o.getLongitude().toFixed(2)},t=new n({title:"{address}",description:"Latitude: {lat}<br/>Longitude: {lon}"}),r=new l(o,i,a,t),map.graphics.add(r)}function w(e){for(var i=new d(map.spatialReference),a=0;a<e.length;a++)i.addPoint(e[a].feature.geometry);map.setExtent(i.getExtent().expand(2))}function x(){map.infoWindow.hide(),map.graphics.clear()}function k(e,i,a,t,o){return new c({angle:0,xoffset:i,yoffset:a,type:"esriPMS",url:e,contentType:"image/png",width:t,height:o})}map=e("mapDiv",{basemap:"gray",center:[-82.745,41.699],zoom:10});var C=new a({map:map},"homeButton");C.startup();var I=new t({map:map},h.byId("measurementDiv"));I.startup(),esri.config.defaults.io.corsEnabledServers.push("http://52.0.108.106:6080/"),$(window).resize(function(){$("#legendCollapse").hasClass("in")?(maxLegendHeight=.9*$("#mapDiv").height(),$("#legendElement").css("height",maxLegendHeight),$("#legendElement").css("max-height",maxLegendHeight),maxLegendDivHeight=$("#legendElement").height()-parseInt($("#legendHeading").css("height").replace("px","")),$("#legendDiv").css("max-height",maxLegendDivHeight)):$("#legendElement").css("height","initial")}),y(map,"load",function(){var e=map.getScale().toFixed(0);$("#scale")[0].innerHTML=addCommas(e);var i=p.webMercatorToGeographic(map.extent.getCenter());$("#latitude").html(i.y.toFixed(3)),$("#longitude").html(i.x.toFixed(3))}),y(map,"zoom-end",function(){var e=map.getScale().toFixed(0);$("#scale")[0].innerHTML=addCommas(e)}),y(map,"mouse-move",function(e){if($("#mapCenterLabel").css("display","none"),null!=e.mapPoint){var i=p.webMercatorToGeographic(e.mapPoint);$("#latitude").html(i.y.toFixed(3)),$("#longitude").html(i.x.toFixed(3))}}),y(map,"pan-end",function(){$("#mapCenterLabel").css("display","inline");var e=p.webMercatorToGeographic(map.extent.getCenter());$("#latitude").html(e.y.toFixed(3)),$("#longitude").html(e.x.toFixed(3))});var D=new r("http://basemap.nationalmap.gov/arcgis/rest/services/USGSTopo/MapServer");y(h.byId("btnStreets"),"click",function(){map.setBasemap("streets"),map.removeLayer(D)}),y(h.byId("btnSatellite"),"click",function(){map.setBasemap("satellite"),map.removeLayer(D)}),y(h.byId("btnHybrid"),"click",function(){map.setBasemap("hybrid"),map.removeLayer(D)}),y(h.byId("btnTerrain"),"click",function(){map.setBasemap("terrain"),map.removeLayer(D)}),y(h.byId("btnGray"),"click",function(){map.setBasemap("gray"),map.removeLayer(D)}),y(h.byId("btnNatGeo"),"click",function(){map.setBasemap("national-geographic"),map.removeLayer(D)}),y(h.byId("btnOSM"),"click",function(){map.setBasemap("osm"),map.removeLayer(D)}),y(h.byId("btnTopo"),"click",function(){map.setBasemap("topo"),map.removeLayer(D)}),y(h.byId("btnNatlMap"),"click",function(){map.addLayer(D)});var V=new s({value:"",maxLocations:25,autoComplete:!0,arcgisGeocoder:!0,autoNavigate:!1,map:map},"geosearch");V.startup(),V.on("select",f),V.on("findResults",b),V.on("clear",x),y(V.inputNode,"keydown",function(e){13==e.keyCode&&v()});var z=k("../src/images/purple-pin.png",0,12,13,24);map.on("load",function(){map.infoWindow.set("highlight",!1),map.infoWindow.set("titleInBody",!1)}),y(h.byId("btnGeosearch"),"click",L),$(document).ready(function(){function e(){$("#geosearchModal").modal("show")}$("#geosearchNav").click(function(){e()}),$("#html").niceScroll(),$("#sidebar").niceScroll(),$("#sidebar").scroll(function(){$("#sidebar").getNiceScroll().resize()}),$("#legendDiv").niceScroll(),maxLegendHeight=.9*$("#mapDiv").height(),$("#legendElement").css("max-height",maxLegendHeight),$("#legendCollapse").on("shown.bs.collapse",function(){maxLegendHeight=.9*$("#mapDiv").height(),$("#legendElement").css("max-height",maxLegendHeight),maxLegendDivHeight=$("#legendElement").height()-parseInt($("#legendHeading").css("height").replace("px","")),$("#legendDiv").css("max-height",maxLegendDivHeight)}),$("#legendCollapse").on("hide.bs.collapse",function(){$("#legendElement").css("height","initial")})}),require(["esri/dijit/Legend","esri/tasks/locator","esri/tasks/query","esri/tasks/QueryTask","esri/graphicsUtils","esri/geometry/Point","esri/geometry/Extent","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/FeatureLayer","esri/layers/WMSLayer","esri/layers/WebTiledLayer","esri/layers/WMSLayerInfo","dijit/form/CheckBox","dijit/form/RadioButton","dojo/query","dojo/dom","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/on"],function(e,i,a,t,o,r,s,n,l,d,c,p,m,h,y,v,L,f,b,S){var M=[],w=[];const x="http://wlera.wimcloud.usgs.gov:6080/arcgis/rest/services/WLERA/",k=new n(x+"reference/MapServer",{id:"hexRef",visible:!0});k.setVisibleLayers([0]),w.push(k),M.push({layer:k,title:" "}),k.inLegendLayers=!0;const C=new n(x+"reference/MapServer",{id:"studyArea",visible:!0});C.setVisibleLayers([1]),w.push(C),M.push({layer:C,title:" "}),C.inLegendLayers=!0;const I=new l(x+"reference/MapServer/2",{id:"parcels",visible:!1,minScale:1e5,mode:l.MODE_ONDEMAND,outfields:["*"]});w.push(I),I.inLegendLayers=!1;const D=new n(x+"hydroCondition/MapServer",{id:"dikeBreaks",visible:!1,minScale:1e5});D.setVisibleLayers([1]),w.push(D),D.inLegendLayers=!1;const V=new n(x+"hydroCondition/MapServer",{id:"culverts",visible:!1,minScale:1e5});V.setVisibleLayers([2]),w.push(V),V.inLegendLayers=!1;const z=new n(x+"hydroCondition/MapServer",{id:"degFlowlines",visible:!1,minScale:1e5});z.setVisibleLayers([3]),w.push(z),z.inLegendLayers=!1;const E=new n(x+"hydroCondition/MapServer",{id:"dikes",visible:!1,minScale:1e5});E.setVisibleLayers([5]),w.push(E),E.inLegendLayers=!1;const G=new n(x+"hydroCondition/MapServer",{id:"dikedAreas",visible:!1});G.setVisibleLayers([6]),w.push(G),G.inLegendLayers=!1;const j=new n(x+"restorationModel/MapServer",{id:"waterMask",visible:!1});j.setVisibleLayers([2]),w.push(j),j.inLegendLayers=!1;const B=new n(x+"restorationModel/MapServer",{id:"hydroperiod",visible:!1});B.setVisibleLayers([3]),w.push(B),B.inLegendLayers=!1;const H=new n(x+"restorationModel/MapServer",{id:"wetsoils",visible:!1});H.setVisibleLayers([4]),w.push(H),H.inLegendLayers=!1;const T=new n(x+"restorationModel/MapServer",{id:"flowline",visible:!1});T.setVisibleLayers([5]),w.push(T),T.inLegendLayers=!1;const q=new n(x+"restorationModel/MapServer",{id:"conservedLands",visible:!1});q.setVisibleLayers([6]),w.push(q),q.inLegendLayers=!1;const F=new n(x+"restorationModel/MapServer",{id:"imperviousSurfaces",visible:!1});F.setVisibleLayers([7]),w.push(F),F.inLegendLayers=!1;const R=new n(x+"restorationModel/MapServer",{id:"landuse",visible:!1});R.setVisibleLayers([8]),w.push(R),R.inLegendLayers=!1;const N=new n(x+"restorationModel/MapServer",{id:"normalized",visible:!0});N.setVisibleLayers([9]),w.push(N),M.push({layer:N,title:" "}),N.inLegendLayers=!0;const A=new n(x+"restorationModel/MapServer",{id:"highRestore",visible:!1});A.setVisibleLayers([11]),w.push(A),A.inLegendLayers=!1;const P=new n(x+"restorationModel/MapServer",{id:"mediumRestore",visible:!1});P.setVisibleLayers([12]),w.push(P),P.inLegendLayers=!1;const W=new n(x+"restorationModel/MapServer",{id:"lowRestore",visible:!1});W.setVisibleLayers([13]),w.push(W),W.inLegendLayers=!1;const O=new n(x+"restorationModel/MapServer",{id:"noRestore",visible:!1});O.setVisibleLayers([14]),w.push(O),O.inLegendLayers=!1,map.addLayers(w);var U=map.enableSnapping({snapKey:u("mac")?g.META:g.CTRL}),X=[{layer:I}];U.setLayerInfos(X);for(var Z=0;Z<map.layerIds.length;Z++){var Y=map.getLayer(map.layerIds[Z]);Y.visible&&($("#"+Y.id).button("toggle"),$("#"+Y.id).find("i.checkBoxIcon").toggleClass("fa-check-square-o fa-square-o"))}$("button.lyrTog").click(function(e){$(this).find("i.checkBoxIcon").toggleClass("fa-check-square-o fa-square-o"),$(this).button("toggle"),e.preventDefault(),e.stopPropagation();var i=map.getLayer($(this).attr("id"));i.visible?i.setVisibility(!1):(i.setVisibility(!0),0==i.inLegendLayers&&(M.push({layer:i,title:" "}),K.refresh()))}),$("#hydroConditionGroup, #parametersGroup, #4scaleGroup").on("hide.bs.collapse",function(){var e=$(this)[0].id.replace("Group","");$("#"+e).find("i.checkBoxIcon").toggleClass("fa-check-square-o fa-square-o"),$("#"+e).find("i.chevron").toggleClass("fa-chevron-right fa-chevron-down");var i=$(this).attr("id")+"Buttons";$("#"+i).button("toggle")}),$("#hydroConditionGroup, #parametersGroup, #4scaleGroup").on("show.bs.collapse",function(){var e=$(this)[0].id.replace("Group","");$("#"+e).find("i.checkBoxIcon").toggleClass("fa-check-square-o fa-square-o"),$("#"+e).find("i.chevron").toggleClass("fa-chevron-right fa-chevron-down")}),$(".zoomto").hover(function(e){$(".zoomDialog").remove();var i=this.parentNode.id,a=$('<div class="zoomDialog"><label class="zoomClose pull-right">X</label><br><div class="list-group"><a href="#" id="zoomscale" class="list-group-item zoomscale">Zoom to scale</a> <a id="zoomcenter" href="#" class="list-group-item zoomcenter">Zoom to center</a></div></div>');$("body").append(a),$(".zoomDialog").css("left",event.clientX-80),$(".zoomDialog").css("top",event.clientY-5),$(".zoomDialog").mouseleave(function(){$(".zoomDialog").remove()}),$(".zoomClose").click(function(){$(".zoomDialog").remove()}),$("#zoomscale").click(function(e){var a=map.getLayer(i).minScale;map.setScale(a)}),$("#zoomcenter").click(function(e){var a=map.getLayer(i).fullExtent.getCenter();map.centerAt(a)})}),$(".opacity").hover(function(){$(".opacitySlider").remove();var e=this.parentNode.id,i=map.getLayer(e).opacity,a=$('<div class="opacitySlider"><label id="opacityValue">Opacity: '+i+'</label><label class="opacityClose pull-right">X</label><input id="slider" type="range"></div>');$("body").append(a),$("#slider")[0].value=100*i,$(".opacitySlider").css("left",event.clientX-180),$(".opacitySlider").css("top",event.clientY-5),$(".opacitySlider").mouseleave(function(){$(".opacitySlider").remove()}),$(".opacityClose").click(function(){$(".opacitySlider").remove()}),$("#slider").change(function(i){var a=$("#slider")[0].value/100;console.log("o: "+a),$("#opacityValue").html("Opacity: "+a),map.getLayer(e).setOpacity(a)})});var K=new e({map:map,layerInfos:M},"legendDiv");K.startup()})}),$(document).ready(function(){});